(()=>{"use strict";var t={d:(e,o)=>{for(var n in o)t.o(o,n)&&!t.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:o[n]})},o:(t,e)=>Object.prototype.hasOwnProperty.call(t,e)};t.d({},{m:()=>S,K:()=>b});const e=class{constructor(t){this.length=t,this.sunk=!1,this.hits=Array(t).fill(!1)}isSunk(){return this.hits.every((t=>t))}hit(t){this.hits[t]=!0}};class o{constructor(){this.board=Array(10).fill(null).map((()=>Array(10).fill(null))),this.ships=[],this.shipIdCounter=0}createBoard(t){const e=document.querySelector(`.${t}`);for(let o=0;o<100;o++){const n=document.createElement("div");n.classList.add("cell"),e.appendChild(n),n.setAttribute("id",`${t}-${o}`)}}isAdjacentCellOccupied(t,e){const o=[[-1,-1],[-1,0],[-1,1],[0,-1],[0,1],[1,-1],[1,0],[1,1]];for(let[n,r]of o){const o=t+n,s=e+r;if(o>=0&&o<10&&s>=0&&s<10&&null!==this.board[o][s])return!0}return!1}isValidPlacement(t,e,o,n){if(n&&t+o>10)return!1;if(!n&&e+o>10)return!1;for(let r=0;r<o;r++){const o=n?t:t+r,s=n?e+r:e;if(null!==this.board[o][s]||this.isAdjacentCellOccupied(o,s))return!1}return!0}placeShip(t,o,n=!1,r){const s=document.querySelector(`.${r}`);if(!s)return console.log("Container not found"),!1;const c=Math.floor(t/10),i=t%10;if(!this.isValidPlacement(c,i,o,n))return console.log("Invalid ship placement"),!1;const l=new e(o);for(let t=0;t<o;t++){const e=n?c:c+t,o=n?i+t:i,a=`${r}-${10*e+o}`,u=s.querySelector(`#${a}`);u&&(u.classList.add(`${r}-ship`),u.classList.add("target"),this.board[e][o]={ship:l,position:t})}return this.ships.push({ship:l,startRow:c,startCol:i,length:o,isHorizontal:n,id:this.shipIdCounter}),this.shipIdCounter++,console.log("Ship placed"),console.log(this.board),!0}receiveAttack(t,e){if(null!==this.board[t][e]){const{ship:o,position:n}=this.board[t][e];return o.hit(n),console.log(`hit at ${t}, ${e}`),this.determineSunkState(o),!0}return!1}determineSunkState(t){t.isSunk()&&(t.sunk=!0)}allShipsSunk(){return this.ships.every((({ship:t})=>t.sunk))}}let n=!0;const r=new Set;let s=[];function c(t,e){document.querySelector(".gameboard-c").querySelectorAll(".cell").forEach((t=>{t.addEventListener("click",(()=>{const e=a(t);!function(t,e,o){!r.has(e)&&n&&(function(t){if(!n)return;let e=!1;const o=a(t),{row:r,col:s}=u(o);t.classList.contains("target")?(d(t,"sunk"),e=!0,S.receiveAttack(r,s),f(S,"Player")):d(t,"non-ship-cell"),console.log(S.board),function(t,e){const{row:o,col:n}=u(t),r=e.board[o][n];console.log(r)}(o,S),e?c():(n=!1,h(),setTimeout((()=>i()),1e3))}(t),r.add(e))}(t,e)}))}))}function i(t){let e=[];const o=document.querySelectorAll(".cell");if(console.log(s),s.length>0){const t=s.shift(),{row:e,col:o}=u(t),n=document.querySelector(`#gameboard-p-${t}`);if(n)return void l(n)}if(o.forEach((t=>{t.classList.contains("non-ship-cell")||t.classList.contains("sunk")||e.push(t)})),0===e.length)return;const n=Math.floor(Math.random()*e.length);l(e[n])}function l(t){const e=a(t),{row:o,col:c}=u(e),l=document.querySelector(`#gameboard-p-${e}`);let d=!1;l.classList.contains("target")?(l.classList.add("sunk"),b.receiveAttack(o,c),d=!0,f(b,"Computer"),function(t,e){[{row:-1,col:0},{row:1,col:0},{row:0,col:-1},{row:0,col:1}].forEach((o=>{const n=t+o.row,c=e+o.col,i=10*n+c;n>=0&&n<10&&c>=0&&c<10&&(r.has(i)||s.push(i))}))}(o,c)):l.classList.add("non-ship-cell"),console.log(b.board),d?setTimeout((()=>i()),1e3):(n=!0,h())}function a(t){const e=t.id.match(/\d+/g);return parseInt(e,10)}function u(t){return{row:Math.floor(t/10),col:t%10}}function d(t,e){t.classList.add(`${e}`)}function h(){document.querySelector(".whoseTurnh2").textContent=n?"Player's Turn":"Computer's Turn"}function f(t,e){t.allShipsSunk()&&function(t){document.querySelector(".whoseTurnh2").textContent=`${t} Wins!`}(e)}function p(){let t,e=[10,20,30,40,50,60,70,80,90,100];do{t=Math.floor(100*Math.random())}while(e.includes(t));return t}function m(){const t=Math.floor(4*Math.random())+2;return console.log(t),t}function g(t,e,o){const n=Math.floor(t/10);if(o){if(t%10+e>10)return!1}else if(n+e>10)return!1;return!0}const S=new o,b=new o;document.addEventListener("DOMContentLoaded",(()=>{function t(o,n){e.addEventListener("click",(()=>{location.reload()}));const{startId:r,length:s,isHorizontal:c}=function(){let t,e,o,n;do{t=p(),e=m(),o=Math.random()>=.5,n=g(t,e,o)}while(!n);return{startId:t,length:e,isHorizontal:o}}();o.placeShip(r,s,c,n)||t(o,n)}b.createBoard("gameboard-p"),S.createBoard("gameboard-c");const e=document.querySelector("#resetBtn");e.addEventListener("click",(()=>{!function(){for(let e=0;e<4;e++)t(b,"gameboard-p"),t(S,"gameboard-c")}()})),c()}))})();